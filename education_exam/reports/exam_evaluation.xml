<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <record id="legal_landscape_evaluation" model="report.paperformat">
            <field name="name">Legal Landscape for  evaluation</field>
            <field name="default" eval="True" />
            <field name="format">Legal</field>
            <field name="page_height">0</field>
            <field name="page_width">0</field>
            <field name="orientation">Landscape</field>
            <field name="margin_top">20</field>
            <field name="margin_bottom">30</field>
            <field name="margin_left">7</field>
            <field name="margin_right">7</field>
            <field name="header_line" eval="False" />
            <field name="header_spacing">15</field>
            <field name="dpi">100</field>
        </record>


        <template id="external_layout_evaluations">
        <div class="header" >
            <div class="row">
                <div style="width: 100%;text-align:center;">
                    <h4 style="text-transform: uppercase;" t-if="res_company.name"><span t-field="res_company.name"/></h4>
                    <h5 t-if="res_company.street"><span t-field="res_company.street"/><t t-if="res_company.street2"><span t-field="res_company.street2"/> </t></h5>
                        <h5 t-if="res_company.country_id"><span t-field="res_company.country_id"/></h5>
                </div>
            </div>
        </div>
            <div class="article">
          <t t-raw="0" />
        </div>

        <!--<div class="footer o_boxed_footer">-->
           <div class="footer">
               <div class="row">
                    <br/><br/><br/><br/>
               </div>
               <div class="row">
                   <div class="col-xs-4" style="font-size:16px;">Signature of Class Teacher</div>
                   <div class="col-xs-4" style="font-size:16px;">Compared By</div>
                   <div class="col-xs-4" style="font-size:16px;">Signature of The Principal</div>
               </div>
               <div class="row" >
                   <table style="border:none;width:100%;">
                       <tr>
                           <td style="text-align: left; padding-left: 300px; font-size:9px;">Powered by Eagle ERP</td><td></td>
                           <td style="text-align: right; font-size:9px;"><span >Page </span><span class="page" /> of <span class="topage" /></td>
                       </tr>
                   </table>

               </div>
            </div>
        <!--</div>-->
    </template>

        <template id="optional_paper_numbers">
            <td style='background-color : #E8E8E8;' t-att-rowspan="2">
                <t t-esc="half_round_up(paper_line.paperline.tut_obt,0)"/>
            </td>
            <td style='background-color : #E8E8E8;' t-att-rowspan="2">
                <t t-esc="half_round_up(paper_line.paperline.subj_obt,0)"/>
            </td>
            <td style='background-color : #E8E8E8;' t-att-rowspan="2">
                <t t-esc="half_round_up(paper_line.paperline.obj_obt,0)"/>
            </td>
            <td style='background-color : #E8E8E8;' t-att-rowspan="2">
                <t t-esc="half_round_up(paper_line.paperline.prac_obt,0)"/>
            </td>
            <!--<td style='background-color : #E8E8E8;'>
                <t t-esc="half_round_up(paper_line.paperline.paper_obt,0)"/>
            </td>-->
        </template>

        <template id="average_optional_paper_numbers">
            <td style='background-color : #E8E8E8;'  t-att-rowspan="2">
                <t t-esc="paper_line.paperline.tut_obt" />
            </td>
            <td style='background-color : #E8E8E8;'  t-att-rowspan="2">
                <t t-esc="paper_line.paperline.subj_obt"/>
            </td>
            <td style='background-color : #E8E8E8;' t-att-rowspan="2">
                <t t-esc="paper_line.paperline.obj_obt"/>
            </td>
            <td style='background-color : #E8E8E8;' t-att-rowspan="2">
                <t t-esc="paper_line.paperline.prac_obt"/>
            </td>
            <!--<td style='background-color : #E8E8E8;'>
                <t t-esc="paper_line.paperline.paper_obt"/>
            </td>-->
        </template>

        <template id="general_paper_numbers">
            <td  t-att-rowspan="2">
                <t t-esc="half_round_up(paper_line.paperline.tut_obt)"/>
            </td>
            <td  t-att-rowspan="2">
                <t t-esc="half_round_up(paper_line.paperline.subj_obt)"/>
            </td>
            <td  t-att-rowspan="2">
                <t t-esc="half_round_up(paper_line.paperline.obj_obt)"/>
            </td>
            <td  t-att-rowspan="2">
                <t t-esc="half_round_up(paper_line.paperline.prac_obt)"/>
            </td>
            <!--<td >
                <t t-esc="half_round_up(paper_line.paperline.paper_obt)"/>
            </td>-->
        </template>

        <template id="paper_total_colum_template">

            <t t-if="paper_first">
                <td t-att-rowspan="max_paper_count">
                <t t-esc="half_round_up(paper_line.subjectline.subject_obt)"/>
                </td>

            </t>
            <t t-if="paper_index==1">
                <td t-att-rowspan="max_paper_count">
                    <t t-esc="paper_line.subjectline.letter_grade"/>
                </td>

            </t>
        </template>

        <template id="empty_paper_marks">
            <td  t-att-rowspan="2">
                <!--Tut -->
            </td>
            <td  t-att-rowspan="2">
                <!--Subj -->
            </td>
            <td  t-att-rowspan="2">
                <!--obj -->
            </td>
            <td  t-att-rowspan="2">
                <!--Prac -->
            </td>
            <!--<td >
                &lt;!&ndash;Total &ndash;&gt;
            </td>-->
        </template>

        <template id="average_general_paper_numbers">
            <td  t-att-rowspan="2">
                <t t-esc="paper_line.paperline.tut_obt"/>
            </td>
            <td  t-att-rowspan="2">
                <t t-esc="paper_line.paperline.subj_obt"/>
            </td>
            <td  t-att-rowspan="2">
                <t t-esc="paper_line.paperline.obj_obt"/>
            </td>
            <td  t-att-rowspan="2">
                <t t-esc="paper_line.paperline.prac_obt"/>
            </td>
            <!--<td >
                <t t-esc="paper_line.paperline.paper_obt"/>
            </td>-->
        </template>

        <template id="paper_body">
            <t t-if="paper_line.paperline.paper_id in student.optional_subjects">
                <t t-if='len(exam_line.exam_ids)>1'>
                    <t t-call="education_exam.average_optional_paper_numbers"/>
                </t>
                <t t-else="">
                    <t t-call="education_exam.optional_paper_numbers"/>
                </t>
            </t>
            <t t-else="">
                <t t-if='len(exam_line.exam_ids)>1'>
                    <t t-call="education_exam.average_general_paper_numbers"/>
                </t>
                <t t-else="">
                    <t t-call="education_exam.general_paper_numbers"/>
                </t>
            </t>
        </template>


        <template id="evaluation_data_layout">
            <div class="page">
                <div class="oe_structure">
                    <div class="row" style="text-align:center">
                        <h4>
                            <t t-foreach="result_exam_lines" t-as="exam_line">

                                <t t-if="exam_line_last" >
                                    <span t-field="exam_line.name"/> <span > Examination</span>
                                </t>
                                <t t-else="">
                                    <span t-field="exam_line.name"/> <span>,   </span>
                                </t>
                            </t>
                        </h4>
                    </div>
                    <div class="container">
                        <table  style="width : 100%;text-align:center">
                            <tr>
                               <td>
                                   <span t-field="section.class_id.name"/>
                               </td>
                                <td >
                                        <span>Section : </span>
                                        <span t-field="section.display"/>
                                </td>
                                <td>
                                        <t t-if="section.division_id">
                                            <span>Group : </span>
                                            <span t-field="section.division_id.name"/>
                                        </t>
                                        <t t-else="">
                                            <span> Group: N/A</span>
                                        </t>
                                </td>
                            </tr>

                        </table>
                    </div>
                    <div class="row">
                        <table width="100%" >
                            <THEAD>
                                <tr>
                                    <th rowspan="3">ID</th>
                                    <th rowspan="3">Roll</th>
                                    <th rowspan="3">Name</th>
                                    <th rowspan="3">Exam</th>
                                    <th rowspan="3">Paper</th>
                                    <!--here 5= mark_type Count and 1 for empty cell after each subject-->
                                    <th t-att-colspan="len(all_subjects)*(5+1)">Subjects</th>
                                    <th t-att-colspan="4" t-att-rowspan="2">Evaluation</th>
                                </tr>
                                <tr>
                                    <t t-foreach="all_subjects" t-as="subject">
                                        <td colspan="5">
                                            <t t-esc="subject.name"/>
                                        </td>
                                        <td>.</td>
                                    </t>
                                </tr>
                                <tr>
                                    <t t-foreach="all_subjects" t-as="subject">
                                        <td >Mth</td>
                                        <td >Sub</td>
                                        <td >Obj</td>
                                        <td >Pra</td>
                                        <td >Total</td>
                                        <td></td>
                                        <t t-if="subject_last">
                                            <td>Total</td>
                                            <td>GPA</td>
                                        </t>
                                    </t>
                                </tr>
                            </THEAD>
                            <tbody style="page-break-inside:avoide !important;">
                                <t t-set="df_results" t-value="get_results(result_exam_lines,section)" />
                                <t t-set="max_paper_count" t-value="get_max_paper_count(result_exam_lines)"/>
                                <t t-set="row_for_student" t-value="max_paper_count*len(result_exam_lines)*2"/>
                                <t t-foreach="students" t-as="student">
                                    <t t-set="df_student" t-value="df_results[(df_results['studentId'] == student.id)]"/>
                                    <!--                                    <t t-set="row_for_student" t-value="df_student.shape[0]"/>-->
                                    <span>&lt;tr&gt;</span>
                                        <td t-att-rowspan="row_for_student">
                                            <t t-esc="student.student_id.student_id"/>
                                        </td>
                                        <td t-att-rowspan="row_for_student">
                                            <t t-esc="student.roll_no"/>
                                        </td>
                                        <td t-att-rowspan="row_for_student">
                                            <t t-esc="student.student_id.name"/>
                                        </td>
                                        <t t-foreach="result_exam_lines" t-as="exam_line">
                                            <td t-att-rowspan="max_paper_count*2">
                                                <t t-esc="exam_line.name"/>
                                            </td>
                                            <t t-set="df_student_exam" t-value="df_student[(df_student['examId']==exam_line.id)]"/>
                                            <t t-foreach="range(1,max_paper_count+1)" t-as="paper">
                                                <t t-set="paper_index" t-value="paper-1"/>
                                                <td t-att-rowspan="2">
                                                   <t t-esc="num2serial(paper)"/>
                                                </td>
                                                <t t-foreach="all_subjects" t-as="subject">

                                                    <t t-set="df_student_exam_subject" t-value="df_student_exam[(df_student_exam['subjectId']==subject.id)]"/>
                                                        <t t-if="df_student_exam_subject.shape[0]>paper_index">
                                                            <t t-set="paper_line" t-value="df_student_exam_subject.iloc[paper_index]"/>
                                                            <t t-call="education_exam.paper_body"/>
                                                        </t>
                                                        <t t-else="">
                                                            <t t-call="education_exam.empty_paper_marks"/>
                                                        </t>
                                                        <t t-call="education_exam.paper_total_colum_template"/>
                                                        <td t-att-rowspan="2"><!--This cell kept blank for each Subject--></td>
                                                <!-- This is for the result at right-->
                                                    <t t-if="subject_last">
                                                        <td t-att-rowspan="2">
                                                            <t t-esc="paper_line.resultline.net_obtained"/>
                                                        </td>
                                                        <td t-att-rowspan="2">
                                                            <t t-esc="paper_line.resultline.net_gpa"/>
                                                        </td>
                                                        <span>&lt;/tr &gt;&lt;tr&gt;</span>
                                                    </t>
                                                </t>
                                                <!-- This is for the secound row for each paper-->
                                                <t t-foreach="all_subjects" t-as="subject">
                                                    <!--<td >
                                                        &lt;!&ndash;Mth&ndash;&gt;
                                                    </td>
                                                    <td >
                                                        &lt;!&ndash;subj&ndash;&gt;
                                                    </td>
                                                    <td >
                                                        &lt;!&ndash;obj&ndash;&gt;
                                                    </td>
                                                    <td >
                                                        p
                                                        &lt;!&ndash;prac&ndash;&gt;
                                                    </td>
                                                    &lt;!&ndash;<td >
                                                        &lt;!&ndash;Total&ndash;&gt;
                                                    </td>&ndash;&gt;
                                                    <td>&lt;!&ndash;keep Blank after each subject &ndash;&gt;</td>-->
                                                    <t t-if="subject_last">
                                                        <span>&lt;/tr &gt;&lt;tr&gt;</span>
                                                    </t>
                                                </t>
                                            </t>

                                        </t>
                                    <!--<tr>
                                        <t t-foreach="result_exam_lines" t-as="exam_line">
                                            <t t-set="results" t-value="get_student_result_line(student,exam_line)"/>
                                            <t t-if="exam_line_first">
                                                <td rowspan="5"><t t-esc="results[exam_line]['res'].student_id.id"/> </td>
                                                <td t-att-rowspan="4"><t t-esc="results[exam_line]['res'].student_history.roll_no"/> </td>
                                                <td t-att-rowspan="4"><t t-esc="results[exam_line]['res'].student_id.name"/> </td>
                                                <td t-att-rowspan="2"><t t-esc="exam_line.name"/> </td>
                                            </t>
                                            <t t-set="index" t-value="0"/>

                                            <t t-foreach="all_subjects" t-as="subject">
                                                <t t-foreach="results[exam_line][subject]['res'].paper_ids" t-as="paper">
                                                   <t t-if="subject_first">
                                                       <t t-if="paper_index==0">
                                                            <td>1st </td>
                                                       </t>
                                                       <t t-if="paper_index==1">
                                                            <td>2nd </td>
                                                       </t>
                                                       <t t-if="paper_index==2">
                                                            <td>3rd </td>
                                                       </t>
                                                   </t>
                                                    <td>
                                                        <t t-esc="paper.tut_obt"/>
                                                    </td>
                                                    <td>
                                                        <t t-esc="paper.subj_obt"/>
                                                    </td>
                                                    <td>
                                                        <t t-esc="paper.obj_obt"/>
                                                    </td>
                                                    <td>
                                                        <t t-esc="paper.prac_obt"/>
                                                    </td>
                                                    <td>
                                                        <t t-esc="paper.paper_obt"/>
                                                    </td>

                                                </t>
                                            </t>
                                            <span>&lt;/tr &gt;&lt;tr&gt;</span>
                                        </t>
                                    </tr>-->
                                </t>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </template>

        <template id="report_exam_evaluation">
            <style>
                .border_less{
                border:none
                }
            </style>
            <t t-call="web.html_container">
                <t t-set="converted_report" t-value="get_converted_report(docs)"/>
                <t t-foreach="get_sections(docs)" t-as="section">
                    <t t-set="result_exam_lines" t-value="get_exam_result_lines(docs)" />
                    <t t-set="all_subjects" t-value="get_all_subjects(section,result_exam_lines)"/>
                    <t t-set="students" t-value="get_students(docs,section)"/>
                    <t t-set="exam_count" t-value="len(result_exam_lines)"/>
                    <t t-call="education_exam.external_layout_evaluations">
                        <style>
                            table,tbody ,tr, th {
                            border: 1px solid black;
                            padding-left:0px;
                            padding-right:0px;
                            padding-top:0px;
                            padding-bottom:0px;
                            text-align: center;
                            vertical-align: middle;
                            }
                            td{
                            border: 0.5px solid black;
                            vertical-align: top;
                            padding-left:0px;
                            padding-right:0px;
                            padding-top:0px;
                            padding-bottom:0px;
                            text-align: center;
                            vertical-align: middle;
                            }

                            .right_top{
                            float:right;
                            padding-top:0px;
                            padding-right:100px;
                            }
                            .left_top{
                            float:left;
                            padding-top:0px;
                            padding-left:100px;
                            }
                            .center_top{
                            float:left;
                            padding-top:0px;
                            padding-left:500px;
                            }
                        </style>
                        <t t-call="education_exam.evaluation_data_layout"/>
                    </t>
                </t>
            </t>
        </template>
    </data>
</odoo>

